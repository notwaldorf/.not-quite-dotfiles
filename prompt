# Fix the git_prompt_info output for oh-my-zsh.
ZSH_THEME_GIT_PROMPT_PREFIX="on %{$fg[cyan]%}"
ZSH_THEME_GIT_PROMPT_SUFFIX="%{$reset_color%}"
ZSH_THEME_GIT_PROMPT_UNTRACKED="%{$fg[cyan]%}"

ZSH_THEME_GIT_PROMPT_AHEAD="%{$reset_color%}â‡¡"
ZSH_THEME_GIT_PROMPT_BEHIND="%{$reset_color%}â‡£"

# set colours if you have text here. i have emoji because obviously.
#ZSH_THEME_GIT_PROMPT_DIRTY=""
#ZSH_THEME_GIT_PROMPT_CLEAN=""


# Fastest possible way to check if repo is dirty. Thanks btford for anything that looks magical in here.
git_dirty() {
  # check if we're in a git repo
  command git rev-parse --is-inside-work-tree &>/dev/null || return
  # check if it's dirty
  # using these emoji make multi line commands be broken and appear on one line. shrug.
  #command git diff --quiet --ignore-submodules HEAD &>/dev/null; [ $? -eq 1 ] && echo 'â˜”ï¸' || echo 'â˜€ï¸'
  command git diff --quiet --ignore-submodules HEAD &>/dev/null; [ $? -eq 1 ] && echo 'â›ˆ' || echo 'ðŸŒž'
}

# If it's a git repo, add the git prompt
git_prompt_go() {
  # check if we're in a git repo
  command git rev-parse --is-inside-work-tree &>/dev/null || return
  echo ' 'on $(git_current_branch) $(git_prompt_ahead)$(git_prompt_behind)`git_dirty`' '
}

# For my own and others sanity
# git:
# %b => current branch
# %a => current action (rebase/merge)
# prompt:
# %F => color dict
# %f => reset color
# %~ => current path
# %c => trail of %~
# %* => time
# %n => username
# %m => shortname host
# %(?..) => prompt conditional - %(condition.true.false)

read -d '' SILLY_BIT << EOF
(Â´ â–½ï½€).ã€‚ï½â™¡
EOF

battery_status() {
  ~/.not-quite-dotfiles/battery-status
}

# This prompt works in oh-my-zsh because of git_prompt_info magic. See below for regular zsh.
PROMPT='$(battery_status)%F{red}$(echo "$SILLY_BIT") %F{green}%~%F{cyan}`git_prompt_go`%f%F{red} â¥ %f'

# the btford prompt for regular zshs. Uncomment away.
#autoload -Uz vcs_info
#zstyle ':vcs_info:*' enable git # You can add hg too if needed: `git hg`
#zstyle ':vcs_info:git*' formats ' %b'
#zstyle ':vcs_info:git*' actionformats ' %b|%a'

# enable prompt substitution
#setopt PROMPT_SUBST

# And the prompt
#PROMPT='
#%F{red}$(echo "$SILLY_BIT") %F{green}%c%F{cyan}$vcs_info_msg_0_ %F{cyan}%`git_dirty` %f%F{red}â¥ %f'
